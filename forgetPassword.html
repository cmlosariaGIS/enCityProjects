<!DOCTYPE html>
<html>

<head>
    <link rel="stylesheet" href="./forgetPassword.css">
    <title>Login</title>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Be+Vietnam:wght@400;500;700&display=swap">
    <link rel="stylesheet"
        href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    <!-- Firebase -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.0/firebase-app.js";
        import { getAuth, sendPasswordResetEmail } from "https://www.gstatic.com/firebasejs/9.6.0/firebase-auth.js";

        // Initialize Firebase with your project credentials
        const firebaseConfig = {
            apiKey: "AIzaSyAf2PXXQYtiDf7P8bfkm4c7SWWARziSNC8",
            authDomain: "encity-project-sheet-tracker.firebaseapp.com",
            projectId: "encity-project-sheet-tracker",
            storageBucket: "encity-project-sheet-tracker.appspot.com",
            messagingSenderId: "849371984466",
            appId: "1:849371984466:web:010a05c06bd5266699658b",
            measurementId: "G-X3P0YX9EMT"
        };
        
        const app = initializeApp(firebaseConfig);
        const auth = getAuth();

        // Function to handle password reset
        window.resetPassword = async function () {
            const email = document.querySelector('.input[name="email"]').value;
            try {
                // Check if email exists in Firebase users
                await sendPasswordResetEmail(auth, email);
                // If email exists, proceed with password reset
                document.getElementById('passwordResetConfirm-message').textContent = 'Password sent. Check your email.';
            } catch (error) {
                // Handle other errors
                console.error('Error resetting password:', error.message);
                if (error.code === 'auth/user-not-found') {
                    // If email doesn't exist in Firebase users
                    document.getElementById('error-message').textContent = '❌ Email not found.';
                } else {
                    // If there's another error
                    document.getElementById('error-message').textContent = '❌ Error resetting password.';
                }
            }
        }
    </script>
</head>

<body>
    <div class="form-container">
        <img src="https://i.ibb.co/rGN5GwP/logo-encity.png" alt="enCity Logo" class="company-logo">
        <p class="title">Forgot Password?</p>
        <h6 class="sub-title">Reset your password to access the enCity Projects Tracker</h6>
        <form class="form" onsubmit="event.preventDefault(); resetPassword();">
            <input type="email" class="input" name="email" placeholder="Provide Your Email">
            <button type="submit" class="form-btn">Reset my Password</button><br>
            <p id="passwordResetConfirm-message" class="passwordResetConfirm-message"></p>
            <p id="error-message" class="error-message"></p> <!-- Display error message -->
        </form>
        <p class="back-to-login-label">
            Back to <span class="login-link">Login Page</span>
        </p>
    </div>

    <script>
        const signUpLink = document.querySelector('.login-link');
        signUpLink.addEventListener('click', () => {
            window.location.href = 'index.html';
        });
    </script>
</body>

</html>
